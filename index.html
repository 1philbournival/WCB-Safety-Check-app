<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorkSafeBC Safety Reporter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script type="module">
        // Import all necessary Firebase functions from their specific modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
        import { getFirestore, addDoc, collection, onSnapshot, query, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

        // Firebase global variables
        let app;
        let db;
        let auth;
        let userId;
        
        // This is your unique Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyABJua7dv8LYdRdZKucvs71p_jEtyC8lg4",
          authDomain: "wcb-app-a1ab3.firebaseapp.com",
          projectId: "wcb-app-a1ab3",
          storageBucket: "wcb-app-a1ab3.firebasestorage.app",
          messagingSenderId: "343441876733",
          appId: "1:343441876733:web:c3e36e7fa56661363b8094",
          measurementId: "G-BSKC7GX98V"
        };
        const appId = firebaseConfig.projectId;

        // Categorized checklist data based on the WorkSafeBC document
        const categorizedChecklists = {
            "General Conditions": [
                { id: 'gen-1', text: 'All walkways are clear and free of tripping hazards.' },
                { id: 'gen-2', text: 'Emergency exits are unobstructed and clearly marked.' },
                { id: 'gen-3', text: 'All workers are wearing appropriate PPE for the task.' },
                { id: 'gen-4', text: 'Machinery guards are in place and functioning properly.' },
                { id: 'gen-5', text: 'Lighting is adequate for the task and free of glare.' },
                { id: 'gen-6', text: 'Work areas are arranged to allow safe movement.' },
                { id: 'gen-7', text: 'All workers have been trained on safe work procedures.' },
                { id: 'gen-8', text: 'Lifting devices and rigging are in good condition and certified.' },
                { id: 'gen-9', text: 'Fire extinguishers are in place, inspected, and easily accessible.' },
                { id: 'gen-10', text: 'Waste and debris are collected and disposed of regularly.' },
            ],
            "Fall Protection": [
                { id: 'fall-1', text: 'A fall protection plan is on site and available to workers.' },
                { id: 'fall-2', text: 'Guardrails are installed on all open sides of elevated work areas.' },
                { id: 'fall-3', text: 'Fall protection systems (e.g., harnesses) are inspected before each use.' },
                { id: 'fall-4', text: 'Anchor points are certified and rated to support the required load.' },
                { id: 'fall-5', text: 'Scaffolds are properly erected, stable, and have all required components.' },
                { id: 'fall-6', text: 'Ladders are set up on a stable surface and at the correct angle (4:1 ratio).' },
                { id: 'fall-7', text: 'Holes in floors and roofs are covered and clearly marked.' },
                { id: 'fall-8', text: 'Workers are properly trained to use all fall protection equipment.' },
                { id: 'fall-9', text: 'Aerial lifts and platforms are inspected daily before use.' },
            ],
            "Demolition": [
                { id: 'dem-1', text: 'A pre-demolition inspection has been conducted for hazardous materials.' },
                { id: 'dem-2', text: 'All utilities (electrical, gas, water) are disconnected and locked out.' },
                { id: 'dem-3', text: 'Workers are aware of the demolition plan and sequence of operations.' },
                { id: 'dem-4', text: 'Sufficient shoring is in place to prevent premature structural collapse.' },
                { id: 'dem-5', text: 'Debris is cleared safely and regularly to prevent pile-up and hazards.' },
                { id: 'dem-6', text: 'Dust control measures (e.g., watering) are in place and effective.' },
                { id: 'dem-7', text: 'Access to the demolition zone is restricted to authorized personnel.' },
            ],
            "Excavation": [
                { id: 'exc-1', text: 'The excavation site is clearly marked and protected from vehicle traffic.' },
                { id: 'exc-2', text: 'Shoring or sloping is in place to prevent trench collapse.' },
                { id: 'exc-3', text: 'Workers are not working under raised loads from excavators or cranes.' },
                { id: 'exc-4', text: 'Excavation has a safe means of access and egress (ladder, ramp).' },
                { id: 'exc-5', text: 'Spoils (excavated soil) are kept at least 1 meter from the edge of the excavation.' },
                { id: 'exc-6', text: 'A competent person has inspected the trench daily and after rain.' },
                { id: 'exc-7', text: 'Underground services (pipes, cables) have been located and marked.' },
            ],
            "First Aid": [
                { id: 'fa-1', text: 'The workplace first aid kit is fully stocked and easily accessible.' },
                { id: 'fa-2', text: 'First aid attendants are on site and have proper training and certification.' },
                { id: 'fa-3', text: 'Emergency phone numbers and procedures are clearly posted.' },
                { id: 'fa-4', text: 'A process is in place to transport an injured worker to a medical facility.' },
                { id: 'fa-5', text: 'Records of all injuries and first aid treatments are kept.' },
            ],
            "MSI": [
                { id: 'msi-1', text: 'Work areas and tasks are arranged to minimize awkward postures and repetitive motion.' },
                { id: 'msi-2', text: 'Proper tools and equipment are available to reduce physical strain.' },
                { id: 'msi-3', text: 'Workers have received training on how to prevent musculoskeletal injuries (MSI).' },
                { id: 'msi-4', text: 'Tasks involving manual handling of heavy items are minimized or eliminated.' },
                { id: 'msi-5', text: 'Regular rest breaks are scheduled for highly repetitive tasks.' },
            ],
            "Hazardous Materials (WHMIS)": [
                { id: 'whmis-1', text: 'All hazardous materials are correctly labeled according to WHMIS regulations.' },
                { id: 'whmis-2', text: 'Safety Data Sheets (SDS) are accessible to all workers for every hazardous product on site.' },
                { id: 'whmis-3', text: 'Workers have received WHMIS training and know how to use SDS.' },
                { id: 'whmis-4', text: 'Appropriate PPE for handling hazardous materials is available and used correctly.' },
                { id: 'whmis-5', text: 'Hazardous materials are stored in a designated, secure area.' },
                { id: 'whmis-6', text: 'Spill kits are available for all hazardous materials in use.' },
            ],
            "Tools & Equipment": [
                { id: 'te-1', text: 'All tools and equipment are inspected regularly for defects or damage.' },
                { id: 'te-2', text: 'All tools are used with appropriate guards and safety features in place.' },
                { id: 'te-3', text: 'Damaged tools are tagged and removed from service immediately.' },
                { id: 'te-4', text: 'Power cords are in good condition, not frayed, and are properly grounded.' },
                { id: 'te-5', text: 'Tools and equipment are stored safely to prevent falling or tripping hazards.' },
                { id: 'te-6', text: 'Workers are trained on the safe use and maintenance of all tools they use.' },
            ]
        };

        // UI elements
        const categoryCheckboxes = document.getElementById('categoryCheckboxes');
        const checklistContainer = document.getElementById('checklist-items');
        const submitButton = document.getElementById('submitButton');
        const recentReportsContainer = document.getElementById('recent-reports');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const reporterNameInput = document.getElementById('reporterName');
        const weatherSelect = document.getElementById('weatherSelect');
        const weatherNotes = document.getElementById('weatherNotes');

        // Functions
        function renderChecklist(selectedCategories) {
            checklistContainer.innerHTML = '';
            
            if (selectedCategories.length === 0) {
                checklistContainer.innerHTML = '<p class="text-gray-500">Please select at least one category to generate a checklist.</p>';
                return;
            }

            let allItems = [];
            selectedCategories.forEach(category => {
                const items = categorizedChecklists[category] || [];
                if (items.length > 0) {
                    // Add a category header
                    allItems.push({ type: 'categoryHeader', text: category });
                    allItems.push(...items);
                }
            });

            if (allItems.length === 0) {
                checklistContainer.innerHTML = '<p class="text-gray-500">No checklist items found for the selected categories.</p>';
                return;
            }

            allItems.forEach(item => {
                if (item.type === 'categoryHeader') {
                    const header = document.createElement('h3');
                    header.className = 'text-xl font-semibold text-gray-700 mt-6 mb-2';
                    header.textContent = item.text;
                    checklistContainer.appendChild(header);
                } else {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'check-item';
                    itemDiv.setAttribute('data-id', item.id);
                    itemDiv.setAttribute('data-category', item.text);
                    itemDiv.innerHTML = `
                        <div class="flex-grow">
                            <p class="text-gray-700 font-medium">${item.text}</p>
                            <textarea rows="2" placeholder="Add comments..." class="comment-input text-sm text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div class="flex-shrink-0 ml-4 flex space-x-2">
                            <button class="status-button pending" onclick="setStatus('${item.id}', 'Pass')">Pass</button>
                            <button class="status-button pending" onclick="setStatus('${item.id}', 'Fail')">Fail</button>
                        </div>
                    `;
                    checklistContainer.appendChild(itemDiv);
                }
            });
        }

        window.setStatus = (itemId, status) => {
            const itemElement = document.querySelector(`.check-item[data-id="${itemId}"]`);
            if (!itemElement) return;
            const buttons = itemElement.querySelectorAll('.status-button');
            
            buttons.forEach(btn => {
                btn.classList.remove('pass', 'fail');
                btn.classList.add('pending');
            });
            const selectedButton = Array.from(buttons).find(btn => btn.textContent.toLowerCase() === status.toLowerCase());
            if (selectedButton) {
                selectedButton.classList.remove('pending');
                selectedButton.classList.add(status.toLowerCase());
            }
        };

        async function submitChecklist() {
            if (!userId) {
                alert('Authentication not ready. Please wait a moment.');
                return;
            }

            const reporterName = reporterNameInput.value.trim();
            if (!reporterName) {
                alert('Please enter your name before submitting.');
                return;
            }

            const selectedCategories = Array.from(document.querySelectorAll('input[name="category"]:checked')).map(checkbox => checkbox.value);
            if (selectedCategories.length === 0) {
                alert('Please select at least one category.');
                return;
            }

            const results = [];
            let allItemsChecked = true;

            document.querySelectorAll('.check-item').forEach(itemElement => {
                const id = itemElement.getAttribute('data-id');
                const category = itemElement.getAttribute('data-category');
                const question = itemElement.querySelector('p').textContent;
                const comment = itemElement.querySelector('textarea').value;
                const statusButton = itemElement.querySelector('.status-button.pass, .status-button.fail');
                
                let status = 'Pending';
                if (statusButton) {
                    status = statusButton.textContent;
                } else {
                    allItemsChecked = false;
                }

                results.push({
                    id: id,
                    category: category,
                    question: question,
                    status: status,
                    comment: comment
                });
            });

            if (!allItemsChecked) {
                alert('Please check all items before submitting.');
                return;
            }
            
            weatherData = {
                conditions: weatherSelect.value,
                notes: weatherNotes.value.trim()
            };

            try {
                loadingIndicator.classList.remove('hidden');
                const reportsCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/reports`);
                const newReportRef = await addDoc(reportsCollectionRef, {
                    timestamp: serverTimestamp(),
                    categories: selectedCategories,
                    checklist: results,
                    reporterName: reporterName,
                    weather: weatherData
                });

                generatePDF(results, newReportRef.id, selectedCategories.join(', '), reporterName);
                loadingIndicator.classList.add('hidden');
                
            } catch (e) {
                console.error("Error adding document or generating PDF: ", e);
                loadingIndicator.classList.add('hidden');
            }
        }

        async function generatePDF(results, reportId, categories, reporterName) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const title = "WorkSafeBC Safety Report";
            const date = new Date().toLocaleDateString();
            const time = new Date().toLocaleTimeString();

            doc.setFont('helvetica', 'bold');
            doc.setFontSize(20);
            doc.text(title, 10, 20);

            doc.setFont('helvetica', 'normal');
            doc.setFontSize(12);
            doc.text(`Report ID: ${reportId}`, 10, 30);
            doc.text(`Reporter: ${reporterName}`, 10, 36);
            doc.text(`Date: ${date} ${time}`, 10, 42);
            doc.text(`Categories: ${categories}`, 10, 48);

            let yOffset = 60;
            const lineHeight = 7;

            if (weatherData) {
                doc.setFontSize(10);
                doc.text(`Weather conditions: ${weatherData.conditions}`, 10, yOffset);
                yOffset += lineHeight;
                if (weatherData.notes) {
                    doc.text(`Notes: ${weatherData.notes}`, 10, yOffset);
                    yOffset += lineHeight;
                }
                yOffset += lineHeight;
            }
            
            let currentCategory = '';
            results.forEach((item, index) => {
                if (item.category !== currentCategory) {
                    doc.setFont('helvetica', 'bold');
                    doc.setFontSize(14);
                    doc.text(`${item.category}`, 10, yOffset);
                    yOffset += lineHeight * 2;
                    currentCategory = item.category;
                    doc.setFontSize(12);
                }
                
                doc.setFont('helvetica', 'bold');
                doc.text(`${index + 1}. ${item.question}`, 10, yOffset);
                yOffset += lineHeight;

                doc.setFont('helvetica', 'normal');
                doc.text(`Status: ${item.status}`, 15, yOffset);
                yOffset += lineHeight;
                
                doc.text(`Comments: ${item.comment || 'N/A'}`, 15, yOffset);
                yOffset += lineHeight * 2;
                
                if (yOffset > 280) {
                    doc.addPage();
                    yOffset = 20;
                }
            });

            doc.save(`WorkSafeBC_Report_${reportId}.pdf`);
            showModal('Checklist submitted and PDF generated successfully! Check your downloads folder.');
        }

        function showModal(message, reportData = null) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50';
            let contentHtml = `<h2 class="text-xl font-bold mb-4 text-gray-800">Success!</h2>
                               <p class="text-gray-700 mb-4">${message}</p>`;

            if (reportData) {
                const date = reportData.timestamp ? new Date(reportData.timestamp.seconds * 1000).toLocaleString() : 'N/A';
                contentHtml = `<h2 class="text-xl font-bold mb-4 text-gray-800">Report Details</h2>
                               <p class="text-sm text-gray-600 mb-2"><strong>ID:</strong> ${reportData.id}</p>
                               <p class="text-sm text-gray-600 mb-2"><strong>Reporter:</strong> ${reportData.reporterName || 'N/A'}</p>
                               <p class="text-sm text-gray-600 mb-4"><strong>Date:</strong> ${date}</p>
                               <p class="text-sm text-gray-600 mb-4"><strong>Categories:</strong> ${reportData.categories.join(', ')}</p>`;
                
                if (reportData.weather) {
                    contentHtml += `<div class="p-3 mb-4 rounded-lg bg-blue-50">
                                        <p class="font-semibold text-gray-700">Weather:</p>
                                        <p class="text-sm text-gray-600"><strong>Conditions:</strong> ${reportData.weather.conditions}</p>`;
                    if (reportData.weather.notes) {
                        contentHtml += `<p class="text-sm text-gray-600"><strong>Notes:</strong> ${reportData.weather.notes}</p>`;
                    }
                    contentHtml += `</div>`;
                }

                contentHtml += `<div class="max-h-96 overflow-y-auto pr-2">`;
                let currentCategory = '';
                reportData.checklist.forEach(item => {
                    if (item.category !== currentCategory) {
                         contentHtml += `<h3 class="text-md font-semibold mt-4 mb-1">${item.category}</h3>`;
                         currentCategory = item.category;
                    }
                    contentHtml += `<div class="p-3 mb-2 rounded-lg ${item.status === 'Fail' ? 'bg-red-50' : 'bg-green-50'}">
                                        <p class="font-semibold">${item.question}</p>
                                        <p class="text-sm">Status: <span class="font-bold">${item.status}</span></p>
                                        <p class="text-sm">Comments: ${item.comment || 'N/A'}</p>
                                    </div>`;
                });
                contentHtml += `</div>`;
            }

            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 shadow-xl max-w-2xl w-full relative">
                    ${contentHtml}
                    <div class="flex justify-end mt-4">
                        <button onclick="closeModal()" class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors">Close</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        window.closeModal = () => {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) {
                modal.remove();
            }
        };

        async function initializeFirebase() {
            try {
                // Initialize Firebase with your personal configuration
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                // Sign in anonymously for simple internal use
                await signInAnonymously(auth);

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("Authentication successful. User ID:", userId);

                        const reportsCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/reports`);
                        onSnapshot(query(reportsCollectionRef), (querySnapshot) => {
                            let reportsHtml = '';
                            if (querySnapshot.empty) {
                                reportsHtml = '<p class="text-gray-500">No reports found.</p>';
                            } else {
                                querySnapshot.forEach((doc) => {
                                    const report = doc.data();
                                    const date = report.timestamp ? new Date(report.timestamp.seconds * 1000).toLocaleString() : 'N/A';
                                    reportsHtml += `
                                        <div class="bg-gray-100 p-4 rounded-lg mb-2 shadow-sm cursor-pointer hover:bg-gray-200 transition-colors" onclick="viewReport('${doc.id}')">
                                            <p class="font-bold">Report ID: ${doc.id}</p>
                                            <p class="text-sm text-gray-600">Categories: ${report.categories.join(', ')}</p>
                                            <p class="text-sm text-gray-600">Date: ${date}</p>
                                        </div>
                                    `;
                                });
                            }
                            recentReportsContainer.innerHTML = reportsHtml;
                        });
                    } else {
                        console.log("No user is signed in.");
                        userId = null;
                    }
                });

            } catch (e) {
                console.error("Error during Firebase initialization or sign-in:", e);
                alert("Failed to initialize the app. Please check the console for errors.");
            }
        }
        
        window.viewReport = async (reportId) => {
            try {
                const reportsCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/reports`);
                const q = query(reportsCollectionRef);
                const querySnapshot = await new Promise(resolve => {
                    onSnapshot(q, resolve);
                });
                
                let foundReport = null;
                querySnapshot.forEach(doc => {
                    if (doc.id === reportId) {
                        foundReport = { ...doc.data(), id: doc.id };
                    }
                });
                
                if (foundReport) {
                    showModal('Report details:', foundReport);
                } else {
                    alert('Report not found.');
                }
            } catch (e) {
                console.error("Error fetching report:", e);
                alert("Failed to retrieve the report. Please check the console.");
            }
        };

        // Event listeners and initial setup
        window.addEventListener('load', () => {
            initializeFirebase();
            const allCategories = Object.keys(categorizedChecklists);
            let categoryCheckboxesHtml = '';
            allCategories.forEach(category => {
                categoryCheckboxesHtml += `
                    <label class="inline-flex items-center mr-4 mb-2">
                        <input type="checkbox" name="category" value="${category}" class="form-checkbox text-blue-600 rounded-md">
                        <span class="ml-2 text-gray-700">${category}</span>
                    </label>
                `;
            });
            categoryCheckboxes.innerHTML = categoryCheckboxesHtml;
            
            categoryCheckboxes.addEventListener('change', () => {
                const selectedCategories = Array.from(document.querySelectorAll('input[name="category"]:checked')).map(checkbox => checkbox.value);
                renderChecklist(selectedCategories);
            });

            submitButton.addEventListener('click', submitChecklist);
        });
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 700px;
        }
        .form-container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 24px;
        }
        .check-item {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            background-color: #f9fafb;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 12px;
        }
        .status-button {
            padding: 8px 16px;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            border: 1px solid #d1d5db;
        }
        .status-button.pending {
            background-color: #f3f4f6;
            color: #4b5563;
        }
        .status-button.pass {
            background-color: #d1fae5;
            color: #065f46;
            border-color: #065f46;
        }
        .status-button.fail {
            background-color: #fee2e2;
            color: #991b1b;
            border-color: #991b1b;
        }
        .comment-input {
            width: 100%;
            padding: 8px;
            margin-top: 8px;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            resize: vertical;
        }
        .user-id-box {
            background-color: #e5e7eb;
            color: #4b5563;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            text-align: center;
            overflow-wrap: break-word;
        }
        #loadingIndicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 2rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 1rem;
            z-index: 1000;
        }
    </style>
</head>
<body>

<div class="container mx-auto p-4">
    <div class="form-container">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">Workplace Safety Checklist</h1>
        <p class="text-center text-gray-500 mb-6">Based on WorkSafeBC residential construction guidelines.</p>
        
        <div class="mb-4">
            <label for="reporterName" class="block text-gray-700 font-medium mb-2">Reporter Name:</label>
            <input type="text" id="reporterName" class="block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., Jane Doe">
        </div>

        <div id="weatherInfo" class="mb-6">
            <label for="weatherSelect" class="block text-gray-700 font-medium mb-2">Weather Conditions:</label>
            <select id="weatherSelect" class="block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                <option value="Clear">Clear</option>
                <option value="Partly Cloudy">Partly Cloudy</option>
                <option value="Overcast">Overcast</option>
                <option value="Light Rain">Light Rain</option>
                <option value="Heavy Rain">Heavy Rain</option>
                <option value="Snow">Snow</option>
                <option value="Windy">Windy</option>
                <option value="Foggy">Foggy</option>
            </select>
            <input type="text" id="weatherNotes" class="mt-2 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Add specific notes (e.g., 'wet ground', 'light breeze')">
        </div>

        <div class="mb-6">
            <label class="block text-gray-700 font-medium mb-2">Select one or more categories:</label>
            <div id="categoryCheckboxes" class="flex flex-wrap gap-2">
                <!-- Checkboxes will be dynamically added here -->
            </div>
        </div>

        <div id="checklist-items">
            <!-- Checklist items will be populated here by JavaScript -->
        </div>

        <div class="flex items-center justify-center space-x-4 mt-6">
            <button id="submitButton" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-colors">
                Submit & Generate PDF
            </button>
        </div>
        
        <div class="mt-8">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Recent Reports</h2>
            <div id="recent-reports" class="space-y-2">
                <!-- Recent reports will be displayed here -->
            </div>
        </div>
    </div>
</div>
<div id="loadingIndicator" class="hidden">
    <p>Generating report and saving to database...</p>
</div>

</body>
</html>
